# Results {#sec:results}

## Evaluation of Emulators {#sec:results-evaluation}

In order to assess the performance of the emulator, two sets of $n=10,000$ samples were drawn using maximin Latin Hypercube Sampling from the parameter space defined in Table \ref{table:single_mode_params}. This randomized design ensured that representative, equal numbers of samples were drawn from across the multi-dimensional parameter space. In the first set, variables whose logarithms were used to build the emulator were sampled in logarithmic space; in the second set, these variables were transformed back to their original values (e.g. from $\log_{10} N$ to $N$) before the sample was constructed. The two independent sets were blended together to assess the emulator. This helps ensure that both very high and very low values of the log-transformed are thoroughly represented within the sample. The set of sample parameter sets were run through all the derived chaos expansions of all orders, as well as the detailed parcel model as a reference benchmark for activation dynamics.

Figure \ref{fig:single_mode_LHS} illustrates the performance of a 4th-order expansion whose coefficients were derived using ordinary least squares. The large range of initial temperatures, pressures, aerosol populations, and updraft speeds sampled here leads to a very large range of supersaturation maxima achieved by the ascending parcel. Weaker updraft speeds are generally associated with lower maximum supersaturations and corresponding to lower aerosol activated fraction; the opposite is true when strong updrafts are present, although there are some cases where a strong updraft activates a small fraction of aerosol. This typically occurs when initial aerosol size distribution is shifted towards larger radii and under polluted conditions with aerosol number concentrations greater than $3,000$ \si{\per\cubic\centi\metre}. However, over the large parameter space sampled, the chaos expansion accurately reproduces the parcel model's determination of $S_\text{max}$ and corresponding activated fraction. 

For parameter sets leading to a large activated fraction of 0.8-1.0, the relative error of the chaos expansion (compared to the parcel model) rarely exceeds 5\%, and on average (for all activated fractions) is 5.7\%. While the mean relative error in each activated fraction decile is close to 0, the standard deviation in the relative error tends to increase for the lower ones; the standard deviation in relative error decreases from 19.7% for activated fractions ranging from 0.1-0.2 to 3.5\% for those ranging from 0.8-0.9. This suggests that there is a non-linear component in the mapping from the input parameter space to the emulated maximum supersaturation and diagnosed droplet number concentration which is prevalent in the weak droplet activation regime; the predicted activated fraction is more sensitive to small changes in the input parameters in this regime than in others.

Increasing the order of the chaos expansion tends to improve the accuracy of the predicted $S_\text{max}$, as recorded in Table \ref{table:smax_stats}. However, there is not much difference between the methods used to compute the coefficients of the expansion beyond expansion order. For example, for the 4th- and 5th-order expansions, the expansions perform equally well regardless of what method (OLS, LARS, or LASSO) was used to compute the coefficients when considering the mean and spread of the relative error to the parcel model reference simulations. In all cases, the chaos expansions produce very large r$^2$ values and normalized fractional root mean square errors ($\text{RMSE}/\sum\limits_{i=1}^n(X_i^2/n)$) which decrease as the order of the expansion increases.

These same statistics, computed for the diagnosed droplet number concentration given the predicted supersaturation maximum, are summarized in Table \ref{table:Nd_stats}. Here, the trend is similar to before; increasing the order of the expansion tends to improve the accuracy of the diagnosed number concentration in terms of mean relative error, and also tends to decrease spread around that value. Third-order expansions tend to produce more accurate results with respect to the mean relative error, but this is overshadowed by the fact that there is far more variance in their predicted values as indicated by the standard deviation of their relative errors, which are almost twice as large as those of the higher-order expansions. 

## Comparison with Other Parameterizations {#sec:results-comparison}

We compare the performance of the chaos expansion-based emulators to two existing parameterizations from the literature. The scheme by @Abdul-Razzak2000 (ARG) - which is widely used in global models - utilizes a psuedo-analytical solution to an integro-differential equation derived from the adiabatic parcel system with embedded aerosol growing via condensation. This is in contrast to the scheme by @MoralesBetancourt2014b (MBN), which instead utilizes an iterative scheme to separate the aerosol population into subsets whose growth is inertially limited or not, and uses this information to derive a maximum supersaturation for a given parcel system. The MBN scheme is generally more expensive to evaluate than the ARG scheme due to its iterative nature, but is often more accurate owing to its consideration of the potentially important effect of large albeit unactivated aerosol particles [@Simpson2014]. In contrast with these schemes, our emulators simulate the activation process based on the explicit numerical solution obtained from a detailed parcel model which is similar to the one used to build and evaluate the MBN scheme [e.g. @Nenes2003] 

The parameter sets used in Section \ref{sec:results-evaluation} were also used to compute droplet activation with the ARG and MBN parameterizations. The relative errors between the supersaturation maximum and droplet number predicted by these schemes and the chaos expansions compared to the parcel model are illustrated in Figure \ref{fig:mre_boxplots}. Both the ARG and MBN parameterizations are more accurate than the 2nd and 3rd order chaos expansions. The ARG scheme tends to underpredict the maximum supersaturation, which is consistent with previous investigations into its performance [@Abdul-Razzak2000; @Ghan2011; @Simpson2014]. This tends to produce a bias towards under-prediction of droplet number. The MBN scheme tends to yield more accurate predictions of both maximum supersaturation and droplet number. However, both schemes are out-performed by the 4th and 5th order chaos expansions, both on average and in terms of the variance of the predictions; for instance, the OLS-derived 4th and 5th order expansions yield relative error in predicted $S_\text{max}$ with a mean and standard deviation of $4.2\% \pm 14.4\%$ and $-0.32\% \pm 10.4\%$, whereas the ARG and MBN schemes yield $-13.7\% \pm 18.2\%$ and $-2.4\% \pm 15.8\%$, respectively. This is larger than other studies have reported, but we explore a much larger parameter space in our sampling for the purposes of deriving the chaos expansion.

As a consequence of tending to slightly under-predict $S_\text{max}$, both the ARG and MBN schemes underpredict the number of activated droplets in the framework considered here. The mean relative error in droplet number predicted by the ARG and MBN schemes for the samples here are $-9.6\% \pm 23.4\%$ and $-4.9\% \pm 16.8\%$, respectively. All of the chaos expansions outperform the mean relative error of the ARG scheme, and those of order $p \geq 3$ do so with less variance. 

In addition to producing low mean relative error in predicted $S_\text{max}$ and droplet number activated, the chaos expansions also reproduce the dependence of activation dynamics on aerosol physical properties and updraft speed, as illustrated in Figure \ref{fig:single_var_sensitivity}. In response to increasing aerosol number concentration, the $S_\text{max}$ reached by an ascending parcel tends to decrease as enhanced competition by aerosol for water vapor produces a larger source of latent heat release and warming, which limits the production of supersaturation; overall this increases the droplet number concentration as the aerosol activated fraction only decreases by a factor of 4 when the total number of initial aerosol increases by an order of magnitude (Figure \ref{fig:single_var_sensitivity}a-b). Shifting the aerosol population to larger sizes (Figure \ref{fig:single_var_sensitivity}c-d) produces a similar effect in inhibiting the increase in a parcel's supersaturation; however, KÃ¶hler theory predicts that these larger particles will more easily activate, which offsets the increase in $S_\text{max}$ and yields larger droplet number concentrations. A similar effect occurs as aerosol hygroscopicity increases (Figure \ref{fig:single_var_sensitivity}e-f). 

The chaos expansions, as well as both the ARG and MBN schemes, capture these subtleties of activation dynamics as well as the detailed parcel model. More importantly, the expansions reproduce the sensitivity of activation to updraft speed (Figure \ref{fig:single_var_sensitivity}g-h) which is the most important factor controlling $S_\text{max}$ and setting the droplet number. At the largest updraft speeds of a few meters per second - indicative of deep, vigorous convection - the MBN scheme outperforms both the chaos expansions and the ARG scheme. However, for the aerosol population considered in Figure \ref{fig:single_var_sensitivity}g-h (with $N = 1000\,\si{\per\cubic\cm}$, $\mu = 0.05\,\si{\micro\metre}$, and $\sigma=2.0$), the relative error in predicted $S_\text{max}$ by the chaos expansions at high updraft speeds does not substantially affect the diagnosed droplet number concentration, since in this case all but the smallest aerosol particles activate under equilibrium considerations. Note that this $S_\text{max}$-overprediction coupled with an accurate assessment of activated fraction occurs for many different single-mode, lognormal aerosol populations.

Since Figure \ref{fig:single_var_sensitivity} highlights the fact that different schemes potentially perform better in different parts of the parameter space governing droplet activation, we stratified the sampling results based on level of pollution and updraft speed strength and computed activated fraction relative error statistics in each of these bins as shown in Figure \ref{fig:stratified_error}. All of the schemes are accurate in clean and lightly polluted conditions (with aerosol number concentration, $N < 1000\,\si{\per\cubic\cm}$). However, there is a tendency for both the ARG and MBN schemes to underpredict droplet number in heavily polluted conditions ($N > 2500\,\si{\per\cubic\cm}$). 

The 4th-order OLS-derived chaos expansion is plotted in Figure \ref{fig:stratified_error}a as a representative example of the chaos expansions, and it retains its accuracy across the pollution level-updraft strength spectrum. The combination of light updrafts and heavy pollution tends to produce the largest under-prediction in activated droplet number, ranging from 10-30\% for the ARG and MBN schemes. Unsurprisingly, relative error in activated fraction tends to be least sensitive to increasing aerosol number concnetration in the strong updraft regime. In this case, the vigorous updraft produces strong adiabatic cooling which overwhelms latent heat release from condensation as the droplets in the parcel grow, producing a large $S_\text{max}$ and thereby activating a significant fraction of the aerosol.

It should be noted that parts of the parameter space we considered in applying the PCM, evaluating its output, and comparing to existing parameterizations may not be typical of real atmospheric cases. We chose a large parameter space in order to derive the most general emulator possible for this particular single mode aerosol case. In the real world, there should be some correlation between the ambient temperatures, pressures, and updraft speeds used when diagnosing aerosol activation, while we sample these factors as if they were independent from one another. The output from applying the parcel model to non-realistic activation scenarios could tend to inflate the computed relative errors and exacerbate differences between the parcel model and the existing, physically-based parameterizations.  

## Computational Efficiency of Chaos Expansions {#sec:comp-efficiency}

As detailed in Appendix \ref{app:pce-emulator}, evaluating the emulator produced by the chaos expansion requires two sets of straightforward floating-point operations. The first set requires the projection of the the input parameters into the vector space spanned by the basis polynomials of the chaos expansion, which can then be used to evaluate the basis polynomials up the required order. The remaining operations simply multiply these intermediate evaluations together and sum them to evaluate the full expansion. In general, this procedure should lie in between the ARG and MBN schemes in terms of computational complexity. The ARG scheme relies on straightforward floating point operations to derive an estimate for $S_\text{max}$ which at worst involve evaluating a logarithm. However, the MBN scheme requires sets of iterations, each of which necessitates a costly evaluation of the error function and the complementary error function. 

On average, the 2nd and 5th-order OLS-derived chaos expansion was 10-17 times faster than the MBN scheme given the same single mode aerosol population. The exact speedup depended on the background velocity; for weak updraft speeds, the performance of the MBN scheme fared better, although it became much worse for updrafts where $V < 2\,\si{\meter\per\second}$. The ARG scheme was consistently 1-3 times faster than those same chaos expansions. Since the pathway for evaluating either the ARG or chaos expansion schemes do not change depending on the input parameters, their performance was the same regardless of what inputs were provided. 

